{
  "id": "mail_thread_signal_creation_job",
  "type": "script",
  "maxRows": 1,
  "script": "import com.lucidworks.searchhub.analytics._\nval mailData = SearchHubLoader.loadFromSolr(SearchHubLoader.Config(sqlContext)).filter(\"_lw_data_source_pipeline_s = 'mailing-list-default'\").select(\"from_email\", \"id\", \"threadId\", \"subject_simple\", \"publishedOnDate\", \"in_reply_to\", \"project\")\nmailData.write.format(\"solr\").options(Map(\"zkhost\" -> \"localhost:9983\", \"collection\" -> \"lucidfind_signals\")).mode(org.apache.spark.sql.SaveMode.Overwrite).save\ncom.lucidworks.spark.util.SolrSupport.getCachedCloudClient(\"localhost:9983\").commit(\"lucidfind_signals\")"
}
